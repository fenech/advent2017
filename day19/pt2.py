s = """                                                                                                                                       |
     +---------------+       +-------+ +-----------------------------------------------------------------------------------------+     |                                               +-----+ +-+
     |               |       |       | |                                                                                         |     |                                               |     | | |
     | +-+ +-----------------|-------+ |           +-+         +-----------+ +---------------------------------------------------------|-----------------------------------------------------+ | |
     | | | |         |       |         |           | |         |           | |                                                   |     |                                               |       | |
   +-+ +---------------------|---------------------------------------------|-+         +---------------------------+             |     |       +-------+                   +-+     +-----------|-+
   |     | |         |       |         |           | |         |           |           |                           |             |     |       |       |                   | |     |   |       |
   |   +---|---+   +-|-------|---------|-----------|-----------+           |           |                           |     +-------|-------------|-------|-------------------|-|-------+ |       |
   |   | | |   |   | |       |         |           | |                     |           |                           |     |       |     |       |       |                   | |     | | |       |
 +-----|---|---|---|-|-------|---------+           +-----+                 |       +-------+ +---------------------------|-------|-------------|-----------------------------------+ | |       |
 | |   | | |   |   | |       |                       |   |                 |       |   |   | |                     |     |       |     |       |       |                   | |       | |       |
 | |   | | |   | +-|-------+ |         +-----------------|-------------+   |       +---|-----|---------------------|-------------|---------------------|---------------+   | |       | |       |
 | |   | | |   | | | |     | |         |             |   |             |   |           |   | |                     |     |       |     |       |       |               |   | |       | |       |
 +---+ | | |   +-----|-------|---------------------------------------------------------|---|-----------+     +-------------------|---+ |       |       |               |   | |       | |       |
   | | | | |     | | |     | |         |             |   |             |   |           |   | |         |     |     |     |       |   | |       |       |               |   | |       | |       |
   | | | +-|-+   +-------+ +-+         |             |   |             |   |           |   | |         |     |     |     |   +---|---+ |       |       |               |   | |       | |       |
   | | |   | |     | |   |             |             |   |             |   |           |   | |         |     |     |     |   |   |     |       |       |               |   | |       | |       |
   +---|-+ | |   +---|---|---------------------------|---|-----------------|---------------------------|-----|-----|---------|---|-----|---------------|-------------+ |   +-|-----+ | | +-----|---+
     | | | | |   | | |   |             |             |   |             |   |           |   | |         |     |     |     |   |   |     |       |       |             | |     |     | | | |     |   |
     | | | | |   | | |   |             |             |   |             |   |           |   | |         |     +-----|----I|---|---|-----------------+   +-------------|-----+ | +-+ | | | |     |   |
     | | | | |   | | |   |             |             |   |             |   |           |   | |         |           |     |   |   |     |       |   |                 | |   | | | | | | | |     |   |
     | | | | |   | | +---|------------------------B--|---|-------------|---------------|-----|---------|-----------|-------------------|-------|---|-----------------|-----|-----|-----|---------+ |
     | | | | |   | |     |             |             |   |             |   |           |   | |         |           |     |   |   |     |       |   |                 | |   | | | | | | | |     | | |
 +-+ | | | | |   | |     |             |       +-----|---|-------------|---------------|---|-|---------------------|---------+   |   +---------|---|-----+           | |   | | | | | | | |     | | |
 | | | | | | |   | |     |             |       |     |   |             |   |           |   | |         |           |     |       |   | |       |   |     |           | |   | | | | | | | |     | | |
 | | | | | | |   | |     |   +-+       |       | +-------|-----------------|-------------+ | |         |           |     |       |   | |       |   |     |           | |   | | | | | | | |     | | +-+
 | | | | | | |   | |     |   | |       |       | |   |   |             |   |           | | | |         |           |     |       |   | |       |   |     |           | |   | | | | | | | |     | |   |
 | | | | | | +---|-------|---|-|-------|---------|---|---|---------------------------------|-|---------------------|---+ |       |   | |       |   |     |           | |   | | | | | | | |     | |   |
 | | | | | |     | |     |   | |       |       | |   |   |             |   |           | | | |         |           |   | |       |   | |       |   |     |           | |   | | | | | | | |     | |   |
 | | | | | |     | |     |   | |       |   +---+ |   |   |             |   |       +---|-|-|-|---------|-----------|---|-------------|-|-------|---|-----------------|-------------------------|---+ |
 | | | | | |     | |     |   | |       |   |     |   |   |             |   |       |   | | | |         |           |   | |       |   | |       |   |     |           | |   | | | | | | | |     | | | |
 | | | | +-|-----------+ |   | |       |   +-----|---|---|-----------------|-----------|---|-----------------------|---|---------|-+ | |       |   |     |           | |   | +---|-|-|---|-+   | | | |
 | | | |   |     | |   | |   | |       |         |   |   |             |   |       |   | | | |         |           |   | |       | | | |       |   |     |           | |   |   | | | | | | |   | | | |
 | | | |   |     | |   | |   | |       |         |   |   +-------------------------|---|---------------|-----------+   | |       | | | |       |   |     |         +-|-|-------|-+ | | | | |   | | | |
 | | | |   |     | |   | |   | |       |         |   |                 |   |       |   | | | |         |               | |       | | | |       |   |     |         | | |   |   |   | | | | |   | | | |
 | | | |   |     | +-----|---|-------------------|---------+           |   |       |   | | | |         |               | |       | | | |       |   |     |         | | |   |   |   | | | | |   | | | |
 | | | |   |     |     | |   | |       |         |   |     |           |   |       |   | | | |         |               | |       | | | |       |   |     |         | | |   |   |   | | | | |   | | | |
 | | | |   |     |     | |   | |       |         |   |     |           |   |       |   | | | |         |               | |       | | | |       |   |     |         | | |   | +-------|-----|---|-|-----+
 | | | |   |     |     | |   | |       |         |   |     |           |   |       |   | | | |         |               | |       | | | |       |   |     |         | | |   | | |   | | | | |   | | | | |
 | | | |   |     |     | +-------------|-------------|-----------------|---|-------|-------------------|---------------|---------------------------|-----------+   | | |   | +-+ +-|---|---|-----|---|-+
 | | | |   |     |     |     | |       |         |   |     |           |   |       |   | | | |         |               | |       | | | |       |   |     |     |   | | |   |     | | | | | |   | | | |
 | | | |   |   +-----------------------------+   |   |     |   +---------------+   |   | | | |         |               | |       | | | |       |   |     |     |   | | |   |     | | | | | |   | | | |
 | | | |   |   | |     |     | |       |     |   |   |     |   |       |   |   |   |   | | | |         |               | |       | | | |       |   |     |     |   | | |   |     | | | | | |   | | | |
 +-|---|-------|-|-+   +-+   | +-------------|---|---|-----|---|-----------|-------|-------|-|-----------------------------------|---|-|-------|---|-----|---------|-|-|---|-----|---+ | | | +-|---|---+
   | | |   |   | | |     |   |         |     |   |   |     |   |       |   |   |   |   | | | |         |               | |       | | | |       |   |     |     |   | | |   |     | |   | | | | | | | | |
 +-|---|-------------+   | +-|---------+   +-+   |   |     |   |       |   |   |   |   | | | |         |               | |       | | | |       |   |     |     |   | | | +---+ +-------|-|-|---|-|---|-+
 | | | |   |   | | | |   | | |             |     |   |     |   |       |   |   |   |   | | | |         |               | |       | | | |       |   |     |     |   | | | | | | | | |   | | | | | | | |
 +---------|---|---|-|-----+ |             |     |   |     |   |       |   |   |   |   | | | |         | +---------------------+ | | | |       |   |     |     |   | | | | | | | | |   | | | | | | | |
   | | |   |   | | | |   |   |             |     |   |     |   |       |   |   |   |   | | | |         | |             | |     | | | | |       |   |     |     |   | | | | | | | | |   | | | | | | | |
   +-|-|-----------------|-----------------+ +---|---------|---+       |   |   |   |   +---|-----------|-|-------------|-------+ | | | |       |   |     |     |   +---|-|-|-|-+ | |   | | | | | | | |
     | |   |   | | | |   |   |               |   |   |     |           |   |   |   |     | | |         | |             | |       | | | |       |   |     |     |     | | | | |   | |   | | | | | | | |
     | |   |   | | | |   |   |               | +-|-------------------------|-------------|-|-+         | +---------------------------|-------------|-----------|-----|-|-|-|---+ | |   | | | | | | | |
     | |   |   | | | |   |   |               | | |   |     |           |   |   |   |     | |           |               | |       | | | |       |   |     |     |     | | | | | | | |   | | | | | | | |
     | |   | +-|-|-------|-----------------------+   |     |   +-+     |   |   |   |     | |           |       +---------|-------|-|-|-|-----------------------|---+ | | | | | | | |   | | | | | | | |
     | |   | | | | | |   |   |               | |     |     |   | |     |   |   |   |     | |           |       |       | |       | | | |       |   |     |     |   | | | | | | | | |   | | | | | | | |
 +-+ | |   | | | | | | +-+   |             +-|-------------|---|-|-----|---|---|-----------|---------------------------|---------|-|-|---------|---------|-----+   | | | | | | | | |   | | | | | | | |
 | | | |   | | | | | | |     |             | | |     |     |   | |     |   |   |   |     | |           |       |       | |       | | | |       |   |     |         | | | | | | | | |   | | | | | | | |
 | | | | +-----|-------|-------------------|-|-------|---------|-------|-----------|-----|-------------|---------------|-|---+ +---|---|-------|---|-----|---------|-|-----------------|-|---+ | | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   |     | |           |       |       | |   | | | | | |       |   |     |         | | | | | | | | |   | | |   | | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | +-----|-----------|-------|-------------|-|-----|-------------|-----|-----------|-|---|-|-+ | |   | | |   | | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   | | | | | |       |   |     |         | | | | | |   | |   | | |   | | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   | +-------|-------|---------|---------|-|-------------|---|---+   | | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   |   | | | |       |   |     |         | | | | | |   | |   | |     | | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   |   | | | |       |   |     |         | | | | | |   +-|-------+   | | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   |   | | | |       |   |     |         | | | | | |     |   | | |   | | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   |   | | | |       |   |     +---------+ | | | | |     +---|-|-|---|-+ | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   |   | | | |       |   |                 | | | | |         | | |   |   | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   |   | | | |       |   |   +---------------|---|-----------|-|-|-------|-|-+
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   |   | | | |       |   |   |             | | | | |         | | |   |   | | |
 | | | | | | | | | | | |     |       +-----|-|-------------|---|-|-----|-------------------|---------------------------|-|---|---|-|-------------------|-------------|-----|-|---------+ | +-----+ | | |
 | | | | | | | | | | | |     |       |     | | |     |     |   | |     |   |   |   | |   | |           |       |       | |   |   | | | |       |   |   |             | | | | |           |     | | | | |
 | | | | | | | | | | | |     |       |     | | |     |     |   | |     |   |   |   +-|-----|-----------|-------|-------+ |   |   | | | |       |   |   |             | | | | |     +-----|-+   | | | | |
 | | | | | | | | | | | |     |       |     | | |     |     |   | |     |   |   |     |   | |           |       |         |   |   | | | |       |   |   |             | | | | |     |     | |   | | | | |
 | | | | | | | | | | | |     |       |     | | |     |     |   | |     |   |   |     |   | |           +-------|-----------------|-|---|---------------|-----------+ | | | | |     | +---|-|-----+ | | |
 | | | | | | | | | | | |     |       |     | | |     |     |   | |     |   |   |     |   | |                   |         |   |   | | | |       |   |   |           | | | | | |     | |   | |   |   | | |
 | | | | | | | | | | | |     |       +-----|-|-------|-----|-----|-----|---|---|-----|--K--|-------------------|---------|---------|-|-----------------|-----------|-------+ | +-----+   | |   |   | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |     |   | |                   |         |   |   | | | |       |   |   |           | | | |   | |   |     | |   |   | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |     |   | |                   |         |   |   | | | |       |   |   |           | | | |   | |   |     | |   |   | | |
 | | | | | | | | | | | |     |             | | |     |     |   | |     |   |   |     |   | |                   |         |   |   | | | |       |   |   |           | | | |   | |   |     | |   |   | | |
 | | | | | | | | | | | +-----|---------------|-------|-----|---|-------|---------------------------------------|---------|---+   | | | |       |   |   |       +---+ | | |   | | +-|-----|---+ |   | | |
 | | | | | | | | | | |       |             | | |     |     |   | |     |   |   |     |   | |                   |         |       | | | |       |   |   |       |     | | |   | | | |     | | | |   | | |
 | | | | | | | +---|-----------------------|-|-------|-----|---+ |     |   |   |     |   | |                   |         |       | | | |       |   |   | +-------------------|-|---|---+ +-|-|-+   | | |
 | | | | | | |   | | |       |             | | |     |     |     |     |   |   |     |   | |                   |         |       | | | |       |   |   | |     |     | | |   | | | |   |   | |     | | |
 | | | | | | | +-|-|-+       |             +---+     |     |   +---------------|---------|---------------------|-----------------|-|-|-----------+ |   | |     |   +-|-|-|-------|---+ |   | |     | | |
 | | | | | | | | | |         |               |       |     |   | |     |   |   |     |   | |                   |         |       | | | |       | | |   | |     |   | | | |   | | | | | |   | |     | | |
 | | | | | | | | | |         |               |       |     |   | |     |   |   |     |   | |                   |       +-|---------|-|---------|---------------|---|-|-|-|-------|-|-|-----|-|-----|-+ |
 | | | | | | | | | |         |               |       |     |   | |     |   |   |     |   | |                   |       | |       | | | |       | | |   | |     |   | | | |   | | | | | |   | |     |   |
 | | | | | | | | | |         |               |       |     |   | |   +---------|-----|---|-+                   |       | |       | | | |       | | |   | |     |   | | | | +---|-----------|-------|-+ |
 | | | | | | | | | |         |               |       |     |   | |   | |   |   |     |   |                     |       | |       | | | |       | | |   | |     |   | | | | | | | | | | |   | |     | | |
 | | | | | | | | | |         |               | +-----|-----------------|---|-------------|---------------------|-----------------|-|-|-|---------|-|-----|-----|-+ +-----|---+ | | | | |   | |     | | |
 | | | | | | | | | |         |               | |     |     |   | |   | |   |   |     |   |                     |       | |       | | | |       | | |   | |     | |   | | | |   | | | | |   | |     | | |
 | | | | | | | +---+         |               +-|-----+     +---|-|-----|---|---|-----|-------------------------------------------|---------------|-|-----|-----|-----|-|-|---+ | | | | |   | |     | | |
 | | | | | | |   |           |                 |               | |   | |   |   |     |   |                     |       | |       | | | |       | | |   | |     | |   | | | | | | | | | |   | |     | | |
 | | | | | | |   | +---------|-----------------+               | |   | |   |   |     |   |     +---------------|-----------------|---|-|-------|-|-|---|-|---------+ | | | | | | | | | |   | |     | | |
 | | | | | | |   | |         |                                 | |   | |   |   |     |   |     |               |       | |       | | | |       | | |   | |     | | | | | | | | | | | | |   | |     | | |
 | | | | | | |   | | +-------|---------------------------------------------|---------|---|-----|-----------------------|---------+ | | |       | | |   | |     | | | | +-----|-|-+ | | |   | |     | | |
 | | | | | | |   | | |       |                                 | |   | |   |   |     |   |     |               |       | |         | | |       | | |   | |     | | | |   | | | |   | | |   | |     | | |
 | | | | | | | +-+ | |       |                                 | |   | |   |   |     |   |     |               |       | |         | | |       | | |   | |     | +---|-----|---|---|-------------+ | | |
 | | | | | | | |   | |       |                                 | |   | |   |   |     |   |     |               |       | |         | | |       | | |   | |     |   | |   | | | |   | | |   | |   | | | |
 | | | | | | | | +-----------|-------------------------------+ | |   | |   |   |     |   |     |               |       | |         | | |       | | |   | |     |   | | +-|-+ | | +-----|---------|-+ | |
 | | | | | | | | | | |       |                               | | |   | |   |   |     |   |     |               |       | |         | | |       | | |   | |     |   | | | |   | | | | | |   | |   |   | |
 | | | | | | | | | +---------|-------------------------------------------------------|---|-----|-----------------------------------|-|-----------------|-----+ |   | | +-----|-+ | | | |   | |   |   | |
 | | | | | | | | |   |       |                               | | |   | |   |   |     |   |     |               |       | |         | | |       | | |   | |   | |   | |   |   |   | | | |   | |   |   | |
 | | | | | +---|-|-------------------+               +-----------------|-------------|---|-+   |               |       +-|---------|---|---------------|-|-----|---|-|-+ | L | +-|---|-|---|-|---|---+ |
 | | | | |   | | |   |       |       |               |       | | |   | |   |   |     |   | |   |               |         |         | | |       | | |   | |   | |   | | | | | | | | | | |   | |   |     |
 | | | | |   | | |   |       |       |               |       | | |   | | +-+   |     |   | |   |               |         |         | | |       | | |   | |   | |   | | | | | | | | | | |   | |   |     |
 | | | | |   | | |   |       |       |               |       | | |   | | |     |     |   | |   |               |         |         | | |       | | |   | |   | |   | | | | | | | | | | |   | |   |     O
 | | | | |   | | |   |       |       |               |       +---+   | | +-----------|---------+               |         |         | | |       | | |   +-|-+ | |   | | | | | | | +---|-+   | |   |     |
 | | | | |   | | |   |       |       |               |         |     | |       |     |   | |                   |         |         | | |       | | |     | | | |   | | | | | | |   | |     | |   |     |
 | | | | | +-----+ +-|-------|-------|-------------------------------|---------|-----|-----|-------+           |         |         | | |       | | |     +-----|-------------|-|---|-----+ | |   | +---+
 | | | | | | | |   | |       |       |               |         |     | |       |     |   | |       |           |         |         | | |       | | |       | | |   | | | | | | |   | |   | | |   | |
 | | | | | | | |   | |       |       |               |         |     | |       |     |   | |       |           |         |         | | |       | | |       | | |   | | | | | | |   | |   | | |   | |
 | | | | | | | |   | |       |       |               |         |     | |       |     |   | |       |           |         |         | | |       | | |       | | |   | | | | | | |   | |   | | |   | |
 | | | | | +---|----N------+ |       |               |         |     | |       |     |   | |       |           |         +-----------------------------+   | | |   | +-|-----|-|---|-+   | | |   | |
 | | | | |   | |   | |     | |       |               |         |     | |       |     |   | |       |           |                   | | |       | | |   |   | | M   |   | | | | |   |     | | |   | |
 | | | | |   | |   | |     | |       |               | +---------------|-------------------|-------|---------------------------------------------|-+   |   | | |   |   | | | | |   |     | | |   | |
 | | | | |   | |   | |     | |       |               | |       |     | |       |     |   | |       |           |                   | | |       | |     |   | | |   |   | | | | |   |     | | |   | |
 | | | | |   | +---|-|-------|-----------------------|-|-------|-------------------------|---------------------|-------------------|-|-|-+     | |     |   | | |   |   | | +-|-+   |     | | |   | |
 | | | | |   |     | |     | |       |               | |       |     | |       |     |   | |       |           |                   | | | |     | |     |   | | |   |   | |   |     |     | | |   | |
 | | | | |   |     | |     | |       |               | +-------|-------|-+     |     |   | |       |           |                   | | | |     | |     |   | | |   |   | |   |     |     | | |   | |
 | | | | |   |     | |     | |       |               |         |     | | |     |     |   | |       |           |                   | | | |     | |     |   | | |   |   | |   |     |     | | |   | |
 | | | | |   | +---|-|-----|-|-------|---------+     |       +---+   +---------|-----------|-------|-----------|-------------------------|-------+     |   | | |   |   | |   |     |     | | |   | |
 | | | | |   | |   | |     | |       |         |     |       | | |     | |     |     |   | |       |           |                   | | | |     |       |   | | |   |   | |   |     |     | | |   | |
 | | +-------------|---------|-----------------------|---------|-|-------------|-----|---|---------|-----------|-------------------|-|-+ |     |       |   | | |   |   | |   |     |     | | |   | | +-+
 | |   | |   | |   | |     | |       |         |     |       | | |     | |     |     |   | |       |           |                   | |   |     |       |   | | |   |   | |   |     |     | | |   | | | |
 | |   | |   | |   | |     | |       |         |     |       | | |     | |     |     |   | |       |           |                   | |   |     |       |   | | |   |   | |   |     |     | | |   | | | |
 | |   | |   | |   | |     | |       |         |     |       | | |     | |     |     |   | |       |           |                   | |   |     |       |   | | |   |   | |   |     |     | | |   | | | |
 | |   | |   | |   | |     +-------------------|-----|-----------|-----|-|-----|-----------|---------------------------------------|-+   |     |       |   | +-|---|-----|-+ |     +-------|---+ | | | |
 | |   | |   | |   | |       |       |         |     |       | | |     | |     |     |   | |       |           |                   |     |     |       |   |   |   |   | | | |           | | | | | | | |
 | |   | |   | |   | |     +-|-------|---------------------------|-----|---------------+ | |       |           |                   |     |     |       |   |   |   |   | | | |           | | | | | | | |
 | |   | |   | |   | |     | |       |         |     |       | | |     | |     |     | | | |       |           |                   |     |     |       |   |   |   |   | | | |           | | | | | | | |
 | |   | |   | |   | |     | |       +-----------------------------------|-----------|---------------------------------------------|-----|-------------|-----------------|-|---+         | | | | | | | |
 | |   | |   | |   | |     | |                 |     |       | | |     | |     |     | | | |       |           |                   |     |     |       |   |   |   |   | | | | |         | | | | | | | |
 | |   | |   | |   | |     | |                 |     |     +-|-|---------|---------------|-|---------------------------------------|-----------|-------|---|-+ |   |   | | | | |         | | | | | | | |
 | |   | |   | |   | |     | |                 |     |     | | | |     | |     |     | | | |       |           |                   |     |     |       |   | | |   |   | | | | |         | | | | | | | |
 | |   | |   | |   | |     | |                 |   +-|-----|-+ | |     | |     |     | | | |       |           |                   |     |     |       |   | | |   |   | | | | |         | | | | | | | |
 | |   | |   | |   | |     | |                 |   | |     |   | |     | |     |     | | | |       |           |                   |     |     |       |   | | |   |   | | | | |         | | | | | | | |
 | |   | |   | +---|-|-----------------------------|-|---------|-------|-|-------------|-|-|-------------------|-------------------------|-----|-------|---|-|---------|-|-|-|-|---------|-+ | | | | | |
 | |   | |   |     | |     | |                 |   | |     |   | |     | |     |     | | | |       |           |                   |     |     |       |   | | |   |   | | | | |         |   | | | | | |
 | |   +-----|-------|-----|-------------------|-----|-----|-----------|-|-----|-------|-|-----------------------------------------|---------+ |       |   | | |   | +---|-|-----------+ |   | | | | | |
 | |     |   |     | |     | |                 |   | |     |   | |     | |     |     | | | |       |           |                   |     |   | |       |   | | |   | | | | | | |       | |   | | | | | |
 | |     |   |     | |     | |                 |   | |     | +-------+ | |     |     | | | |       |           |                   |     |   | |       |   | | |   | | | | | | |       | |   | | | | | |
 | |     |   |     | |     | |                 |   | |     | | | |   | | |     |     | | | |       |           |                   |     |   | |       |   | | |   | | | | | | |       | |   | | | | | |
 | | +-------|-+   | |     | |                 |   | |     +-|---|---|-+ |     |     | | | |       |           |                   |     |   | |       |   | | |   | | | | | | |       | | +---+ | | | |
 | | |   |   | |   | |     | |                 |   | |       | | |   |   |     |     | | | |       |           |                   |     |   | |       |   | | |   | | | | | | |       | | | |   | | | |
 | | |   |   | |   | |     | |                 |   | | +-------|---------------------|-|-------------------------------------------|-----|---|-|-----------|-|-|-----|-|-|-|---+       | | | |   | | | |
 | | |   |   | |   | |     | |                 |   | | |     | | |   |   |     |     | | | |       |           |                   |     |   | |       |   | | |   | | | | | |         | | | |   | | | |
 | | | +-----|-|-----|------------------------------X--|-----|-|-|-------------|-----|---|---------------------|-------+           |     |   | +-------|-----------|-|-----|---------+ | | | |   | | | |
 | | | | |   | |   | |     | |                 |   | | |     | | |   |   |     |     | | | |       |           |       |           |     |   |         |   | | |   | | | | | |       | | | | |   | | | |
 | | | | +-+ | |   | |     | |                 |   | | |     | | |   |   |     |     | | | |       |           |       |       +---------|---|---------|---|-------|-|-----------------|-|--H|-------+ |
 | | | |   | | |   | |     | |                 |   | | |     | | |   |   |     |     | | | |       |           |       |       |   |     |   |         |   | | |   | | | | | |       | | | | |   | |   |
 | | | |   | | |   | |   +---|---------------------|-|-------|---|-------|---------------|---------|-+         |       |       |   |     |   |         |   | | |   | | | | | |       | | | | |   | |   |
 | | | |   | | |   | |   | | |                 |   | | |     | | |   |   |     |     | | | |       | |         |       |       |   |     |   |         |   | | |   | | | | | |       | | | | |   | |   |
 | | | |   +---|---------|-+ |                 | +-----|-----|-------|---------|-----|-|-|---------------------+       |       |   |     |   |         |   | +-------------|-----------+ | | |   | |   |
 | | | |     | |   | |   |   |                 | | | | |     | | |   |   |     |     | | | |       | |                 |       |   |     |   |         |   |   |   | | | | | |       |   | | |   | |   |
 | | | |     | |   | |   |   |                 | | | | +-----+ | |   |   |     |     | | | |     +-|-+                 |       |   |     |   |         |   |   |   | +-|-|---------+ |   | | |   | |   |
 | | | |     | |   | |   |   |                 | | | |         | |   |   |     |     | | | |     | |                   |       |   |     |   |         |   |   |   |   | | | |     | |   | | |   | |   |
 | | | | +---|---+ | | +-|---|-------------------|-|-|---------|-----|---|---------+ | | | |     | |                   |       |   |     |   |         |   |   |   |   | | | |     | |   | | |   | |   |
 | | | | |   | | | | | | |   |                 | | | |         | |   |   |     |   | | | | |     | |                   |       |   |     |   |         |   |   |   |   | | | |     | |   | | |   | |   |
 | | | | +-----+ | | | +-----------------------------------------|-------|-----|-----|-|-|-|-----+ |                   +-----------|---------|-----------------|---|---|---|---+   +-|---------+ | |   |
 | | | |     |   | | |   |   |                 | | | |         | |   |   |     |   | | | | |       |                           |   |     |   |         |   |   |   |   | | | | |     |   | | | | | |   |
 | +---|---------|-|-------------------------------|-|---------|-----|---|-------------|---|-------|-------------------------------------|-------------|---|-+ |   |   | | | | |     |   | | | | | |   |
 |   | |     |   | | |   |   |                 | | | |         | |   |   |     |   | | | | |       |                           |   |     |   |         |   | | |   |   | | | | |     |   | | | | | |   |
 | +-|---+ +-|---|-+ |   +---|-------------------|-|-----------|-|-----+ |     |   | | | | |       |                           |   |     |   |         |   | | |   |   | | | | |     |   | | | | | |   |
 | | | | | | |   |   |       |                 | | | |         | |   | | |     |   | | | | |       |                           |   |     |   |         |   | | |   |   | | | | |     |   | | | | | |   |
 | | | | | | |   +---|-------------------------|-|-------------|-----|---------+   | | | | +-------|---------------------------|---|-----|---|---------|---|-|-----|---|-----|-------|---|-----+ | |   |
 | | | | | | |       |       |                 | | | |         | |   | | |         | | | |         |                           |   |     |   |         |   | | |   |   | | | | |     |   | | |   | |   |
 | | | +-------------|-------+                 | | +-|---------|-|---|-|-----------|-|-----------------+                       |   |     |   |         |   | | |   |   +---|-|-------|---|-|-|-+ | |   |
 | | |   | | |       |                         | |   |         | |   | | |         | | | |         |   |                       |   |     |   |         |   | | |   |     | | | |     |   | | | | | |   |
 | | |   | | |       |                         | |   +---------|-|-----|-|---------|---|-|-+       |   |                       |   |     |   |         |   | | | +-------|---|-------|-------|-|-|-|-+ |
 | | |   | | |       |                         | |             | |   | | |         | | | | |       |   |                       |   |     |   |         |   | | | | |     | | | |     |   | | | | | | | |
 | | |   +-|-----------------------------------|---------------------|-|-|---------|---|-|---------|---+                       |   |     |   |         |   | | | | |     | | | |     |   | | | | | | | |
 | | |     | |       |                         | |             | |   | | |         | | | | |       |                           |   |     |   |         |   | | | | |     | | | |     |   | | | | | | | |
 | | |     | |       |                         | |             | |   | +-------------|---|-------------------------------------|---------|---|---------|-+ | | | | |     | | | |     |   | | | +-|-|-|-+
 | | |     | |       |                         | |             | |   |   |         | | | | |       |                           |   |     |   |         | | | | | | |     | | | |     |   | | |   | | |
 | | |     | |       +-----------------------------------------|-|-------------------|-------------|---------------------------|-----+   |   |         | +-|---|-|-----+ | | | +-----|---|-|---+ | | |
 | | |     | |                                 | |             | |   |   |         | | | | |       |                           |   | |   |   |         |   | | | | |   | | | |       |   | | | | | | |
 +-|-------|-----------------------------------|---------------------|-------------|-|-|---|-------+         +-----------------+   | |   |   |         |   | | | | |   | | | |       |   | | | | | | |
   | |     | |                                 | |             | |   |   |         | | | | |                 |                     | |   |   |         |   | | | | |   | | | |       |   | | | | | | |
   | |     +-|-----------------------------------|---------------|-----------------|---|---|-----------------|---------------------|-------------------+   | | | | |   | | | |       |   | | | | | | |
   | |       |                                 | |             | |   |   |         | Z | | |                 |                     | |   |   |             | | | | |   | | | |       |   | | | | | | |
 +-|-|-------+       +-------------------------|-----------------+   +---+         | | | | |                 |                     | +-----------------------|-+ | |   | | | |       |   | | | | | | |
 | | |               |                         | |             |                   | | | | |                 |                     |     |   |             | |   | |   | | | |       |   | | | | | | |
 +-----------+       +-+                       +-|-------+     +-------------------+ | +---+   +-----------------------------------------------------------|-|---|-|---|-|-|-|-+     |   | | | | | | |
   | |       |         |                         |       |                           |   |     |             |                     |     |   |             | |   | |   | | | | |     |   | | | | | | |
   +---------|---------|-------------------------+       +-------------+             |   |     +-------------|---------------------+     +---------------+ | |   | +---|-----|-----+ |   | +-|-|-+ | |
     |       |         |                                               |             |   |                   |                               |           | | |   |     | | | | |   | |   |   | |   | |
     |       +---------|-----------------------------------------------|---------------------------------------------------------------------------------|-|-----|-----|-|-+ | |   | |   |   | |   | |
     |                 |                                               |             |   |                   |                               |           | | |   |     | |   | |   | |   |   | |   | |
     +-----------------+ +-------------------------------------------------------------------------------------------------------------------+           | | +---|-----|-----|-----|-+   |   | |   | |
                         |                                             |             |   |                   |                                           | |     |     | |   | |   |     |   | |   | |
                         |                                             |             |   |                   |                                           | +-----|-----|-|-----|---|---------+ |   | |
                         |                                             |             |   |                   |                                           |       |     | |   | |   |     |     |   | |
                         +---------------------------------------------------------------|-------------------|-------------------------------------------|-------|-------|---------------+     |   | |
                                                                       |             |   |                   |                                           |       |     | |   | |   |           |   | |
 +---------------------------------------------------------------------|-------------|-----------------------+                                           |       +-------+   | |   |           +---|-+
 |                                                                     |             |   |                                                               |             |     | |   |               |
 |                                                                     +-------------+   |                                                               +-------------|-----+ |   +-----------+   |
 |                                                                                       |                                                                             |       |               |   |
 +---------------------------------------------------------------------------------------+                                                                             +-------+               +---+

"""

grid = [[c for c in row] for row in s.splitlines()]
height = len(grid)
width = max(len(row) for row in grid)

for row in grid:
    row += [' '] * (width - len(row))

state = {
    'x': grid[0].index('|'),
    'y': 0,
    'direction': 'down',
    'seen': []
}

directions = { 'up', 'down', 'left', 'right' }

opposites = {
    'up': 'down',
    'down': 'up',
    'left': 'right',
    'right': 'left'
}

def move(state):
    if state['direction'] == 'up':
        state['y'] -= 1
    elif state['direction'] == 'down':
        state['y'] += 1
    elif state['direction'] == 'left':
        state['x'] -= 1
    elif state['direction'] == 'right':
        state['x'] += 1

def lookahead(state, direction):
    x = state['x']
    y = state['y']

    try:
        if direction == 'up':
            return grid[y - 1][x]
        if direction == 'down':
            return grid[y + 1][x]
        if direction == 'left':
            return grid[y][x - 1]
        if direction == 'right':
            return grid[y][x + 1]
    except IndexError:
        return ' '

def find_direction(state):

    for direction in [state['direction']] + list(directions - { opposites[state['direction']] }):
        if lookahead(state, direction) is not ' ':
            return direction

steps = 1
while True:
    direction = find_direction(state)
    if direction is None:
        break
    state['direction'] = direction
    move(state)
    current = grid[state['y']][state['x']]
    steps += 1

print(steps)
